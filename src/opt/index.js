"use strict";!function(){var n,r=!1,o=io(),c=document.querySelector("canvas"),i={x:c.width,y:c.height},u=c.getContext("2d"),a=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},t=function(e,t){if(r||t){var n={x:Math.trunc(e.layerX/c.clientHeight*i.x),y:Math.trunc(e.layerY/c.clientWidth*i.y)},a=u.createImageData(1,1);a.data[0]=l.r,a.data[1]=l.g,a.data[2]=l.b,a.data[3]=255,o.emit("pixel update",{pos:n,pixel:{r:a.data[0],g:a.data[1],b:a.data[2],a:a.data[3]}}),u.putImageData(a,n.x,n.y)}};!function(){console.log("booting grid");for(var e=c.clientHeight,t=c.clientWidth,n=0;n<i.x;n++){var a=document.createElement("div"),r=document.createElement("div");a.classList.add("vLine"),a.setAttribute("style","left:".concat(e/i.x*(n+1),"px;height:").concat(c.clientHeight,"px;")),r.classList.add("hLine"),r.setAttribute("style","top:".concat(t/i.y*(n+1),"px;width:").concat(c.clientHeight,"px;")),c.parentElement.appendChild(a),c.parentElement.appendChild(r)}}();var l=a(document.querySelector("[type=color]").value);o.on("pixel update",function(e){var t=e.pos,n=u.createImageData(1,1);n.data[0]=e.pixel.r,n.data[1]=e.pixel.g,n.data[2]=e.pixel.b,n.data[3]=e.pixel.a,u.putImageData(n,t.x,t.y)});var d=document.querySelector("form");d.addEventListener("submit",function(e){e.preventDefault();var t=document.querySelector("#username").value;return 0<t.length?(l=a(document.querySelector("[type=color]").value),localStorage.setItem("user",t),o.emit("user registration",{user:t,color:document.querySelector("[type=color]").value})):alert("Please enter a user name"),!1}),o.on("user registration",function(e){e.user&&(document.querySelector("ul").innerHTML+="\n                <li>".concat(e.msg,"</li>\n            ")),e.user==localStorage.getItem("user")&&(c.addEventListener("mousemove",function(e){t(e)}),c.addEventListener("click",function(e){e.preventDefault(),t(e,!0)}),c.addEventListener("mousedown",function(e){e.preventDefault(),r=!0}),c.addEventListener("mouseup",function(e){e.preventDefault(),r=!1}),c.addEventListener("mouseleave",function(e){e.preventDefault(),r=!1}),d.querySelector("label").style.setProperty("display","none"))}),o.on("online users",function(e){var r=document.querySelector("#online");r.innerHTML="",e.forEach(function(e){var t=document.createElement("div"),n=document.createElement("span"),a=document.createElement("div");n.innerHTML=e.user,a.style.setProperty("background",e.color),t.appendChild(a),t.appendChild(n),r.appendChild(t)})}),o.on("new word",function(e){if(document.querySelector("main h1"))document.querySelector("main h1").innerHTML=e;else{var t=document.createElement("h1");t.classList.add("itemName"),t.innerHTML=e,document.querySelector("main").appendChild(t)}e.includes("session")||(n=setInterval(function(){var e=Number(document.querySelector("#timer span").innerHTML);0==(e-=1)?(e=30,document.querySelector("#timer span").innerHTML=e,clearInterval(n)):(document.querySelector("#timer span").innerHTML=e,document.querySelector("#timer").classList.remove("hide"))},1e3))}),o.on("snapshot",function(e){var t=c.toDataURL("image/png"),n=document.querySelector("#snapshots"),a=document.createElement("img"),r=document.createElement("span");a.src=t,r.innerHTML=document.querySelector(".itemName span").innerHTML,r.appendChild(a),n.appendChild(r),u.clearRect(0,0,i.x,i.y)})}();