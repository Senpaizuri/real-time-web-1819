"use strict";!function(){var r=io(),n=document.querySelector("canvas"),o=n.width,u=n.height,l=n.getContext("2d"),a=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},c=a(document.querySelector("[type=color]").value);r.on("pixel update",function(e){var t=e.pos,a=l.createImageData(1,1);a.data[0]=e.pixel.r,a.data[1]=e.pixel.g,a.data[2]=e.pixel.b,a.data[3]=e.pixel.a,l.putImageData(a,t.x,t.y)});var t=document.querySelector("form");t.addEventListener("submit",function(e){e.preventDefault();var t=document.querySelector("#username").value;return 0<t.length?(c=a(document.querySelector("[type=color]").value),localStorage.setItem("user",t),r.emit("user registration",{user:t,color:document.querySelector("[type=color]").value})):alert("Please enter a user name"),!1}),r.on("user registration",function(e){e.user&&(document.querySelector("ul").innerHTML+="\n                <li>".concat(e.msg,"</li>\n            ")),e.user==localStorage.getItem("user")&&(n.addEventListener("mousemove",function(e){var t={x:Math.trunc(e.layerX/n.clientHeight*o),y:Math.trunc(e.layerY/n.clientWidth*u)},a=l.createImageData(1,1);a.data[0]=c.r,a.data[1]=c.g,a.data[2]=c.b,a.data[3]=255,r.emit("pixel update",{pos:t,pixel:{r:a.data[0],g:a.data[1],b:a.data[2],a:a.data[3]}}),l.putImageData(a,t.x,t.y)}),t.querySelector("label").style.setProperty("display","none"))}),r.on("online users",function(e){var n=document.querySelector("#online");n.innerHTML="",e.forEach(function(e){var t=document.createElement("div"),a=document.createElement("span"),r=document.createElement("div");a.innerHTML=e.user,r.style.setProperty("background",e.color),t.appendChild(r),t.appendChild(a),n.appendChild(t)})})}();