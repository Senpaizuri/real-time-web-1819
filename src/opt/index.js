"use strict";!function(){var r=!1,o=io(),u=document.querySelector("canvas"),c={x:u.width,y:u.height},i=u.getContext("2d"),n=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},t=function(e,t){if(r||t){var n={x:Math.trunc(e.layerX/u.clientHeight*c.x),y:Math.trunc(e.layerY/u.clientWidth*c.y)},a=i.createImageData(1,1);a.data[0]=l.r,a.data[1]=l.g,a.data[2]=l.b,a.data[3]=255,o.emit("pixel update",{pos:n,pixel:{r:a.data[0],g:a.data[1],b:a.data[2],a:a.data[3]}}),i.putImageData(a,n.x,n.y)}},l=n(document.querySelector("[type=color]").value);o.on("pixel update",function(e){var t=e.pos,n=i.createImageData(1,1);n.data[0]=e.pixel.r,n.data[1]=e.pixel.g,n.data[2]=e.pixel.b,n.data[3]=e.pixel.a,i.putImageData(n,t.x,t.y)});var a=document.querySelector("form");a.addEventListener("submit",function(e){e.preventDefault();var t=document.querySelector("#username").value;return 0<t.length?(l=n(document.querySelector("[type=color]").value),localStorage.setItem("user",t),o.emit("user registration",{user:t,color:document.querySelector("[type=color]").value})):alert("Please enter a user name"),!1}),o.on("user registration",function(e){e.user&&(document.querySelector("ul").innerHTML+="\n                <li>".concat(e.msg,"</li>\n            ")),e.user==localStorage.getItem("user")&&(u.addEventListener("mousemove",function(e){t(e)}),u.addEventListener("click",function(e){e.preventDefault(),t(e,!0)}),u.addEventListener("mousedown",function(e){e.preventDefault(),r=!0}),u.addEventListener("mouseup",function(e){e.preventDefault(),r=!1}),a.querySelector("label").style.setProperty("display","none"))}),o.on("online users",function(e){var r=document.querySelector("#online");r.innerHTML="",e.forEach(function(e){var t=document.createElement("div"),n=document.createElement("span"),a=document.createElement("div");n.innerHTML=e.user,a.style.setProperty("background",e.color),t.appendChild(a),t.appendChild(n),r.appendChild(t)})}),o.on("booting",function(e){e?document.body.classList.add("loading"):document.body.classList.remove("loading")}),o.on("new word",function(e){if(console.log(e),document.querySelector("main h1"))document.querySelector("main h1").innerHTML=e;else{var t=document.createElement("h1");t.classList.add("itemName"),t.innerHTML=e,document.querySelector("main").appendChild(t)}}),o.on("snapshot",function(e){var t=u.toDataURL("image/png"),n=document.querySelector("#snapshots"),a=document.createElement("img"),r=document.createElement("span");a.src=t,r.innerHTML=document.querySelector(".itemName span").innerHTML,r.appendChild(a),n.appendChild(r),i.clearRect(0,0,c.x,c.y)})}();